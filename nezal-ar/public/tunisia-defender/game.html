<html>
<head>
	<script src="js/base/prototype.js" type="text/javascript"></script>
	<script src="js/base/template.js" type="text/javascript"></script>
	<script src="js/base/effects.js" type="text/javascript"></script>
	<script src="js/nezal/reactor.js" type="text/javascript"></script>
	<style>
		body{
			background-color:white;
		}
		#intro img{
			position: absolute;
			left: 75px;
			top:50px;
			width: 600px;
			height:400px;
			border:2px solid white;
		}
		
		#intro {
			position: relative;
			margin-left: auto;
			margin-right: auto;
			top:25px;
			width: 750px;
			height:550px;		
      background-color: #40a;
		}
		
		#intro #text{
			position: absolute;
			width: 600px;
			top : 460px;
      left:75px;
			color: white;
			font-size: 30px;
			font-family : 'traditional arabic';
			text-align : center;
			font-weight: bold;
		}
		
		#intro #skip{
			position: absolute;
			top : 500px;
			left:600px;
			font-size: 18px;
			font-family : 'traditional arabic';
			font-weight: bold;
		}
		#intro #skip a{
			color:white;
		}
		#intro #skip a:hover{
			color:#40a;
			background-color:white;
		}
		
	</style>
		<script>var target = 'game.html'</script>  
  <!--[if IE]>
		<script>target = 'statics/unsupported_browser.html'</script>
	<![endif]-->
</head>
<body>
  <div id="intro">    
	<div id="text" style="display:none"></div>
	<div id="skip"><a href="#" onclick="done();return false">تخطي المفدمة</a></div>
  </div>
</body>
<script>
	var slideIndex = 0;
	var text = [
		['... لقد خرج الشعب التونسي لاقتلاع الطغاة'],
		['... الذين حاولوا كسر انتفاضة الشعب بكل السبل'],
		['... و لم ينجحوا'],
		['... و ظل الشعب صامدا حتى سقط الطاغية'],
		['و انتصرت تونس ...',
		'قف مع شعب تونس و جيشها في وجه من يخططون لعودة النظام البائد',
		'كن درعا لتونس'],
		['ابني المدافع و طوّرها',
		'لصد فلول أنصار الطاغية',
		'لا تدع قوات الاستبداد تمر']
	]
  function loadImages(){
    for(var i=0;i<6;i++){
        var image = new Image()
        image.onload = loader(image, i)
        image.style.display = 'none'
        image.id = 'image'+i
        image.src = "images/start/"+i+".jpg"
    }
  }
  
  function loader(image, i){
    return function(){
      $('intro').appendChild(image)
      loaded[i] = true
      showSlide(i)
    }
  }
  
  var loaded = [false, false, false, false, false, false];
  var timePassed = [true, false, false, false, false, false]
	var reactor = new Reactor()
	reactor.run()
	function done(){
		reactor.stop()
    window.location = target
	}
  function showSlide(index){
    if(index >= text.length) done()
    if(!(loaded[index] && timePassed[index]))return;
    Effect.Fade('image'+Math.max((index-1),0), {afterFinish:function(){
      Effect.Appear('image'+index)    
    }, afterSetup:function(){
      showText(text[index], index) 
    }})
	}
  
  function showText(t, index){
    Effect.Fade('text', {afterFinish:function(){
      $('text').innerHTML = t.shift()
      Effect.Appear('text')
      if(t.length > 0){
        reactor.push(60, function(){showText(t, index)})
      }else{
        reactor.push(60, function(){timePassed[index+1] = true;showSlide(index+1)})
      }  
     }})
  }
  
	reactor.push(1, function(){loadImages()})
</script>
</html>

